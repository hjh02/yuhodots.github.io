{"componentChunkName":"component---src-templates-post-js","path":"/deeplearning/20-04-22/","result":{"data":{"markdownRemark":{"html":"<p> 딥러닝 생성 모델 중 가장 유명한 Generative Adversarial Networks(생성적 적대 신경망)에 대해 알아보겠습니다. 이를 공부하는데 참고한 자료들은 아래 reference에 적어두었습니다.</p>\n<h3 id=\"generative-adversarial-networks\" style=\"position:relative;\"><a href=\"#generative-adversarial-networks\" aria-label=\"generative adversarial networks permalink\" class=\"anchor-header before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Generative Adversarial Networks</h3>\n<h5 id=\"gan의-구조\" style=\"position:relative;\"><a href=\"#gan%EC%9D%98-%EA%B5%AC%EC%A1%B0\" aria-label=\"gan의 구조 permalink\" class=\"anchor-header before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>GAN의 구조</h5>\n<p> GAN은 2014년 Ian Goodfellow의 논문에서 처음 소개되었습니다. GAN은 Generator(생성자)와 Discriminator(판별자), 두 개의 신경망으로 구성되어있습니다. Discriminator의 목표는 Generator가 만들어낸 이미지가 진짜인지 가짜인지 제대로 판별하는 것이고, Generator의 목표는 Discriminator가 자신이 만든 이미지가 진짜라고 판별하도록 이미지를 잘 생성해내는 것입니다. Discriminator와 Generator가 서로 상반되는 목표를 가지고 적대적으로 학습하여 이미지를 생성한다고 하여, 생성적 적대 신경망이라고 부릅니다. </p>\n<p> GAN의 전체적인 알고리즘은 다음과 같습니다.</p>\n<ol>\n<li>random vector 'z'를 Generator에 전달합니다.</li>\n<li>Generator가 fake image를 생성합니다.</li>\n<li>Discirminator는 real image와 fake image를 입력받아, 0에서 1사이의 확률값을 출력합니다.</li>\n</ol>\n<p>여기서 확률값은 1에 가까우면 실제 이미지로 판별, 0에 가까우면 가짜 이미지로 판별했다는 것을 의미합니다. </p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 760px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/68805965f779e96f1586be62351de7eb/d08c8/20-04-22-1.jpg\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 25.789473684210527%; position: relative; bottom: 0; left: 0; background-image: url('data:image/jpeg;base64,/9j/2wBDABALDA4MChAODQ4SERATGCgaGBYWGDEjJR0oOjM9PDkzODdASFxOQERXRTc4UG1RV19iZ2hnPk1xeXBkeFxlZ2P/2wBDARESEhgVGC8aGi9jQjhCY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2P/wgARCAAFABQDASIAAhEBAxEB/8QAFgABAQEAAAAAAAAAAAAAAAAAAAEF/8QAFAEBAAAAAAAAAAAAAAAAAAAAAP/aAAwDAQACEAMQAAAB34FB/8QAFBABAAAAAAAAAAAAAAAAAAAAEP/aAAgBAQABBQJ//8QAFBEBAAAAAAAAAAAAAAAAAAAAEP/aAAgBAwEBPwE//8QAFBEBAAAAAAAAAAAAAAAAAAAAEP/aAAgBAgEBPwE//8QAFBABAAAAAAAAAAAAAAAAAAAAEP/aAAgBAQAGPwJ//8QAFxAAAwEAAAAAAAAAAAAAAAAAABARYf/aAAgBAQABPyEmr//aAAwDAQACAAMAAAAQc8//xAAUEQEAAAAAAAAAAAAAAAAAAAAQ/9oACAEDAQE/ED//xAAUEQEAAAAAAAAAAAAAAAAAAAAQ/9oACAECAQE/ED//xAAYEAEBAQEBAAAAAAAAAAAAAAABADERQf/aAAgBAQABPxBFx5CPWxf/2Q=='); background-size: cover; display: block;\"\n  ></span>\n  <picture>\n          <source\n              srcset=\"/static/68805965f779e96f1586be62351de7eb/15813/20-04-22-1.webp 190w,\n/static/68805965f779e96f1586be62351de7eb/1cdb2/20-04-22-1.webp 380w,\n/static/68805965f779e96f1586be62351de7eb/9046c/20-04-22-1.webp 760w,\n/static/68805965f779e96f1586be62351de7eb/c89f9/20-04-22-1.webp 1140w,\n/static/68805965f779e96f1586be62351de7eb/4fba2/20-04-22-1.webp 1219w\"\n              sizes=\"(max-width: 760px) 100vw, 760px\"\n              type=\"image/webp\"\n            />\n          <source\n            srcset=\"/static/68805965f779e96f1586be62351de7eb/82f15/20-04-22-1.jpg 190w,\n/static/68805965f779e96f1586be62351de7eb/0246a/20-04-22-1.jpg 380w,\n/static/68805965f779e96f1586be62351de7eb/307d7/20-04-22-1.jpg 760w,\n/static/68805965f779e96f1586be62351de7eb/0470c/20-04-22-1.jpg 1140w,\n/static/68805965f779e96f1586be62351de7eb/d08c8/20-04-22-1.jpg 1219w\"\n            sizes=\"(max-width: 760px) 100vw, 760px\"\n            type=\"image/jpeg\"\n          />\n          <img\n            class=\"gatsby-resp-image-image\"\n            src=\"/static/68805965f779e96f1586be62351de7eb/307d7/20-04-22-1.jpg\"\n            alt=\"img\"\n            title=\"img\"\n            loading=\"lazy\"\n            style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n          />\n        </picture>\n  </a>\n    </span></p>\n<h5 id=\"z에-대해서-vae와-갖는-차이점\" style=\"position:relative;\"><a href=\"#z%EC%97%90-%EB%8C%80%ED%95%B4%EC%84%9C-vae%EC%99%80-%EA%B0%96%EB%8A%94-%EC%B0%A8%EC%9D%B4%EC%A0%90\" aria-label=\"z에 대해서 vae와 갖는 차이점 permalink\" class=\"anchor-header before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>z에 대해서 VAE와 갖는 차이점</h5>\n<p> VAE 같은 경우에는 z값이 encoder에 의해 생성되는 값 입니다. 우리가 생성하려는 데이터를 input으로 줘서 만들어낸 값이 z이기 때문에, z는 우리가 생성하려는 데이터의 feature를 잘 표현하는 어떤 잠재적인 값이 된다고 생각하시면 됩니다. 그래서 이를 <strong>잠재 벡터</strong> 혹은 <strong>표현 벡터</strong>라고 말합니다.</p>\n<p> 하지만 GAN의 z값은 이와는 조금 다릅니다. GAN의 z는 주로 <strong>랜덤 벡터</strong> 혹은 <strong>랜덤 노이즈</strong>라고 불리는데, 이는 VAE와는 달리 z가 우리가 생성하려는 데이터를 잘 설명해 주는 것이 아니라는 걸 의미합니다. 학습 초기의 Generator는 만들어야 하는 데이터가 무엇인지 전혀 알지 못합니다. 그렇다 하더라도 Generator는 데이터를 만들어 내야 합니다. 그렇기에 아무런 의미를 갖지 않는 z를 인풋으로 받고 차원 확대를 하여 데이터를 생성합니다. 그리고 이후에 Discriminator의 피드백에 따라서 weight를 업데이트하며 의미있는(Discriminator에게 높은 점수를 받는) 데이터를 만드는 법을 학습합니다.</p>\n<h3 id=\"gan을-수식으로-이해\" style=\"position:relative;\"><a href=\"#gan%EC%9D%84-%EC%88%98%EC%8B%9D%EC%9C%BC%EB%A1%9C-%EC%9D%B4%ED%95%B4\" aria-label=\"gan을 수식으로 이해 permalink\" class=\"anchor-header before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>GAN을 수식으로 이해</h3>\n<h5 id=\"discriminator의-목적함수\" style=\"position:relative;\"><a href=\"#discriminator%EC%9D%98-%EB%AA%A9%EC%A0%81%ED%95%A8%EC%88%98\" aria-label=\"discriminator의 목적함수 permalink\" class=\"anchor-header before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Discriminator의 목적함수</h5>\n<p> Discriminator는 real image 혹은 fake image를 받아서, 받은 데이터가 real일 확률을 0~1 사이의 값으로 출력합니다. 입력 데이터가 real인 경우에는 1에 가까운 값을 출력하고, fake일 경우에 0에 가까운 값을 출력한다면 Discriminator가 잘 학습되었다고 말할 수 있습니다. Discriminator의 <strong>입력 x에 대한 출력 확률을 D(x)</strong>라 표현한다면, <strong>real에 대해서는 D(x)를 최대화하고 fake에 대해서는 1-D(x)를 최대화</strong> 해야 합니다.</p>\n<h5 id=\"generator의-목적함수\" style=\"position:relative;\"><a href=\"#generator%EC%9D%98-%EB%AA%A9%EC%A0%81%ED%95%A8%EC%88%98\" aria-label=\"generator의 목적함수 permalink\" class=\"anchor-header before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Generator의 목적함수</h5>\n<p> Generator는 자신이 만든 fake image가 Discriminator에게 높은 출력을 받아내야 합니다. 여기서 Generator는 언제나 fake image만을 만들기 때문에, 이는 x=G(z)인 경우에 1-D(x)를 최소화 해야 한다는 것을 의미합니다. 다시 표현하면 <strong>1-D(G(z))를 최소화</strong> 한다는 것을 의미합니다.</p>\n<p> 아래에 GAN의 목적함수에 대해 정리해 보았습니다. 기본적인 목적함수에 log를 취하고, 또 빠른 초기학습을 위해 형태를 조금씩 수정해주는 이유에 대해서는 다른 블로그들과 강의 자료에서 잘 설명되어 있으니 궁금하시다면 꼭 참고하시길 바랍니다. 저는 <a href=\"https://www.youtube.com/watch?v=odpjk7_tGY0\">최윤제님의 naver d2 발표</a>와 <a href=\"https://learnai.tistory.com/3?category=699199\">Kwangmin Choi님 블로그 포스팅</a>자료를 통해 이해했습니다.</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 760px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/5fd532ce134c904a2bc4bf8040d33efa/13b9d/20-04-22-2.jpg\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 42.10526315789473%; position: relative; bottom: 0; left: 0; background-image: url('data:image/jpeg;base64,/9j/2wBDABALDA4MChAODQ4SERATGCgaGBYWGDEjJR0oOjM9PDkzODdASFxOQERXRTc4UG1RV19iZ2hnPk1xeXBkeFxlZ2P/2wBDARESEhgVGC8aGi9jQjhCY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2P/wgARCAAIABQDASIAAhEBAxEB/8QAFgABAQEAAAAAAAAAAAAAAAAAAAEF/8QAFAEBAAAAAAAAAAAAAAAAAAAAAP/aAAwDAQACEAMQAAAB3QUH/8QAFBABAAAAAAAAAAAAAAAAAAAAEP/aAAgBAQABBQJ//8QAFBEBAAAAAAAAAAAAAAAAAAAAEP/aAAgBAwEBPwE//8QAFBEBAAAAAAAAAAAAAAAAAAAAEP/aAAgBAgEBPwE//8QAFBABAAAAAAAAAAAAAAAAAAAAEP/aAAgBAQAGPwJ//8QAGBAAAwEBAAAAAAAAAAAAAAAAAAERcYH/2gAIAQEAAT8hmnBOo//aAAwDAQACAAMAAAAQ89//xAAUEQEAAAAAAAAAAAAAAAAAAAAQ/9oACAEDAQE/ED//xAAUEQEAAAAAAAAAAAAAAAAAAAAQ/9oACAECAQE/ED//xAAbEAEAAwADAQAAAAAAAAAAAAABABEhMUFhgf/aAAgBAQABPxDSZy7bgIjbDybjXyf/2Q=='); background-size: cover; display: block;\"\n  ></span>\n  <picture>\n          <source\n              srcset=\"/static/5fd532ce134c904a2bc4bf8040d33efa/15813/20-04-22-2.webp 190w,\n/static/5fd532ce134c904a2bc4bf8040d33efa/1cdb2/20-04-22-2.webp 380w,\n/static/5fd532ce134c904a2bc4bf8040d33efa/9046c/20-04-22-2.webp 760w,\n/static/5fd532ce134c904a2bc4bf8040d33efa/c89f9/20-04-22-2.webp 1140w,\n/static/5fd532ce134c904a2bc4bf8040d33efa/7bb49/20-04-22-2.webp 1271w\"\n              sizes=\"(max-width: 760px) 100vw, 760px\"\n              type=\"image/webp\"\n            />\n          <source\n            srcset=\"/static/5fd532ce134c904a2bc4bf8040d33efa/82f15/20-04-22-2.jpg 190w,\n/static/5fd532ce134c904a2bc4bf8040d33efa/0246a/20-04-22-2.jpg 380w,\n/static/5fd532ce134c904a2bc4bf8040d33efa/307d7/20-04-22-2.jpg 760w,\n/static/5fd532ce134c904a2bc4bf8040d33efa/0470c/20-04-22-2.jpg 1140w,\n/static/5fd532ce134c904a2bc4bf8040d33efa/13b9d/20-04-22-2.jpg 1271w\"\n            sizes=\"(max-width: 760px) 100vw, 760px\"\n            type=\"image/jpeg\"\n          />\n          <img\n            class=\"gatsby-resp-image-image\"\n            src=\"/static/5fd532ce134c904a2bc4bf8040d33efa/307d7/20-04-22-2.jpg\"\n            alt=\"img\"\n            title=\"img\"\n            loading=\"lazy\"\n            style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n          />\n        </picture>\n  </a>\n    </span> </p>\n<ul>\n<li>이활석님의 <a href=\"https://github.com/hwalsuklee/tensorflow-generative-model-collections\">github repository README</a>를 참고하시면 다양한 GAN의 목적함수를 한 눈에 파악할 수 있습니다.</li>\n</ul>\n<h3 id=\"reference\" style=\"position:relative;\"><a href=\"#reference\" aria-label=\"reference permalink\" class=\"anchor-header before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Reference</h3>\n<ul>\n<li>데이비드 포스터 'Generative Deep Learning' (O'Reilly)</li>\n<li><a href=\"https://pathmind.com/kr/wiki/generative-adversarial-network-gan\">생성적 적대 신경망(GANs)에 대한 초보자용 가이드 (GANs)</a></li>\n<li><a href=\"https://www.youtube.com/watch?v=soJ-wDOSCf4\">김태훈님 PyCon 발표</a></li>\n<li><a href=\"https://learnai.tistory.com/3?category=699199\">Kwangmin Choi님 블로그 포스팅 1</a></li>\n<li><a href=\"https://www.youtube.com/watch?v=odpjk7_tGY0\">최윤제님 naver d2 발표</a></li>\n<li><a href=\"https://github.com/hwalsuklee/tensorflow-generative-model-collections\">이활석님 github repository</a></li>\n</ul>","tableOfContents":"<ul>\n<li>\n<p><a href=\"/MachineLearning/20-04-22-Generative%20Adversarial%20Networks/#generative-adversarial-networks\">Generative Adversarial Networks</a></p>\n<ul>\n<li>\n<ul>\n<li><a href=\"/MachineLearning/20-04-22-Generative%20Adversarial%20Networks/#gan%EC%9D%98-%EA%B5%AC%EC%A1%B0\">GAN의 구조</a></li>\n<li><a href=\"/MachineLearning/20-04-22-Generative%20Adversarial%20Networks/#z%EC%97%90-%EB%8C%80%ED%95%B4%EC%84%9C-vae%EC%99%80-%EA%B0%96%EB%8A%94-%EC%B0%A8%EC%9D%B4%EC%A0%90\">z에 대해서 VAE와 갖는 차이점</a></li>\n</ul>\n</li>\n</ul>\n</li>\n<li>\n<p><a href=\"/MachineLearning/20-04-22-Generative%20Adversarial%20Networks/#gan%EC%9D%84-%EC%88%98%EC%8B%9D%EC%9C%BC%EB%A1%9C-%EC%9D%B4%ED%95%B4\">GAN을 수식으로 이해</a></p>\n<ul>\n<li>\n<ul>\n<li><a href=\"/MachineLearning/20-04-22-Generative%20Adversarial%20Networks/#discriminator%EC%9D%98-%EB%AA%A9%EC%A0%81%ED%95%A8%EC%88%98\">Discriminator의 목적함수</a></li>\n<li><a href=\"/MachineLearning/20-04-22-Generative%20Adversarial%20Networks/#generator%EC%9D%98-%EB%AA%A9%EC%A0%81%ED%95%A8%EC%88%98\">Generator의 목적함수</a></li>\n</ul>\n</li>\n</ul>\n</li>\n<li><a href=\"/MachineLearning/20-04-22-Generative%20Adversarial%20Networks/#reference\">Reference</a></li>\n</ul>","frontmatter":{"path":"/deeplearning/20-04-22/","title":"Generative Adversarial Networks","category":"Deep Learning","date":"2020-04-22"}}},"pageContext":{}},"staticQueryHashes":["2390655019","256249292","63159454"]}